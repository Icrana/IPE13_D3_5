// Code for Pi

// file gateway.items
String Genuino "Genuino [%s]" (genuino) {mqtt="<[mosquitto:/home/rfm_gw/nb/node10/dev1:state:default]"}
String Genuino_knock "Knock [%s]" // knock sensor KY 031
String Genuino_temperature "Temperature [%s]" // temperature KY 001
String Genuino_lightbar "Light barrier [%s]" // light barrier KY 010
String Genuino_button "Button [%s]" // button KY 004
String alarmByLightBar "Alarm [%s]"

// file default.sitemap
sitemap default label="Home Automation Group 5"{
	Frame label="Arduino"{
		Text item=Arduino 
		Text item=Arduino_weight 
		Text item=Arduino_temperature
		Text item=Arduino_light
	}
	Frame label="Genuino"{
		Text item=Genuino 
		Text item=Genuino_knock
		Text item=Genuino_temperature
		Text item=Genuino_lightbar
		Text item=Genuino_button
		Text item=alarmByLightBar
	}
}

// file gateway.rules
rule "alarmByLightBar_rule"
	when 
		Item Genuino_lightbar from OFF to 0N
	then	
		alarmByLightBar.postUpdate("ACTIVATED")
		sendMail("mail@carinamerz.de", "ALARM by Lightbar", "The lightbar alarm has been activated!!!")
end

rule "endAlarm"
	when 
		Item Genuino_button from ON to OFF
	then
		if (alarmByLightBar == ON){
			alarmByLightBar.postUpdate("deactivated"
			sendMail("mail@carinamerz", "Alarmoff", "The lightbar alarm has been deactivated.")
		} 
		else {
		}
end			

// log datei
/var/log/openhab/events.log

